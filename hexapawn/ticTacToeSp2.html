

<!doctype html>
<html>

<head>

<title>Drawing</title>
<script>
	//preload images
	var pawnBImg = new Image();
	pawnBImg.src = "pictures/pawnB.png"
	var pawnWImg = new Image();
	pawnWImg.src = "pictures/pawnW.png"
	//class for the board
	class board {
		constructor(width, height,ctx) 
		{
			if (height > 0 && width > 0) {
				this.height = height;
				this.width = width;
				this.ctx = ctx;
				this.sel = [0,0,1]
				this.isWhite = -1;
				this.pawnSel = false;
				this.clickPos = [0,0];
				this.turn = 2;
				this.board = 
				[
					[1,0,2],
					[1,0,2],
					[1,0,2]
				];
				
				return 0;
			}
			else {
				return 1;
			}
		}
		click(clickX, clickY)
		{
			this.clickPos[0] = (clickX <= this.width / 3 ? 0 : clickX <= this.width / 3 * 2 ? 1 : 2)
			this.clickPos[1] = (clickY <= this.height / 3 ? 0 : clickY <= this.height / 3 * 2 ? 1 : 2)
			//kill an enemy piece if you are black
			if(this.board[this.clickPos[0]][this.clickPos[1]] != this.sel[2])
			{
				this.ctx.font = "50px Arial";
				this.ctx.fillStyle = "white"
				this.ctx.fillText("not your turn", this.width / 2 - 50, this.height / 2);
			}
			else
			{
				if((this.board[this.clickPos[0]][this.clickPos[1]] != 0 && this.board[this.clickPos[0]][this.clickPos[1]] != this.sel[2])&& this.pawnSel&& Math.abs([this.clickPos[0]] - this.sel[0]) == 1 && [this.clickPos[1]] - this.sel[1] == 1 && this.sel[2] == 1)
				{
					this.board[this.clickPos[0]][this.clickPos[1]] = this.sel[2];
					this.board[this.sel[0]][this.sel[1]] = 0;
					this.sel[2] = 0;
					this.pawnSel = false 
					this.drawBoard();
				}
				//kill enemy piece if you are white
				if ((this.board[this.clickPos[0]][this.clickPos[1]] != 0 && this.board[this.clickPos[0]][this.clickPos[1]] != this.sel[2]) && this.pawnSel && Math.abs([this.clickPos[0]] - this.sel[0]) == 1 && [this.clickPos[1]] - this.sel[1] == -1 && this.sel[2] == 2)
				{
					this.board[this.clickPos[0]][this.clickPos[1]] = 2;
					this.board[this.sel[0]][this.sel[1]] = 0;
					this.sel[2] = 0;
					this.pawnSel = false
					this.drawBoard();
					if (this.clickPos[1] == 0) 
					{
						this.gameWin("white");
					}
				}
				//selects a pawn
				else if(this.board[this.clickPos[0]][this.clickPos[1]])
				{
					this.pawnSel = true;

					this.sel[0] = this.clickPos[0];
					this.sel[1] = this.clickPos[1];
					this.sel[2] = this.board[this.clickPos[0]][this.clickPos[1]]
					this.isWhite = this.sel[2] == 2? -1:1;
					this.drawBoard();
				}
				//move black piece
				else if(this.pawnSel && Math.abs([this.clickPos[0]] - this.sel[0]) == 0 && [this.clickPos[1]] - this.sel[1] == 1 && this.sel[2] == 1)
				{
					this.board[this.clickPos[0]][this.clickPos[1]] = 1;
					this.board [this.sel[0]][this.sel[1]] = 0;
					this.sel[2] = 0;
					this.pawnSel = false 
					this.drawBoard();
				}
				//move white piece
				else if (this.pawnSel && Math.abs([this.clickPos[0]] - this.sel[0]) == 0 && [this.clickPos[1]] - this.sel[1] == -1 && this.sel[2]) 
				{
					this.board[this.clickPos[0]][this.clickPos[1]] = 2;
					this.board[this.sel[0]][this.sel[1]] = 0;
					this.sel[2] = 0;

					this.pawnSel = false;
					this.drawBoard();
					if (this.clickPos[1] == 0) 
					{
						this.gameWin("white");
					}
				}
			}
			
		}
		gameWin(winner)
		{
			this.ctx.font = "50px Arial";
			this.ctx.fillStyle = "white"
			this.ctx.fillText(winner + " wins", this.width/2 - 50, this.height/2);
		}
		drawBoard() {
			
			this.ctx.beginPath();
			this.ctx.rect(0, 0, this.width, this.height); // parameters are x,y,width,height
			this.ctx.closePath();
			this.ctx.fillStyle = "#999999";
			this.ctx.fill();
			for(this.y = 0; this.y < 3; this.y++)
			{
				for(this.x = 0; this.x < 3; this.x++)
				{
					if(this.board[this.x][this.y] == 1)
					{
						this.ctx.drawImage(pawnBImg, this.width/3 * this.x + 20, (this.width - 20)/3 * this.y, 150, 150);
					}
					else if (this.board[this.x][this.y] == 2) 
					{
						this.ctx.drawImage(pawnWImg, this.width / 3 * this.x, (this.width - 20) / 3 * this.y, 150, 150);
					}
					this.ctx.beginPath();
					this.ctx.rect(this.width/ 3 * (this.x + 1),0, 10, this.height); // parameters are x,y,width,height
					this.ctx.rect(0, this.height / 3 * (this.y + 1), this.width,10); // parameters are x,y,width,height
					this.ctx.closePath();
					this.ctx.fill();
					this.ctx.fillStyle = "black";
					
				}
			}
		}
		resetboard()
		{
			this.board =
				[
					[1, 0, 1],
					[1, 0, 1],
					[1, 0, 1]
				];
			this.drawBoard();
		}
	}
	function loaded() {
		//code goes here
		var canvas = document.getElementById("myCanvas")
		var ctx = canvas.getContext("2d")
		const game = new board(1000, 800,ctx);
		game.drawBoard(ctx);
		canvas.addEventListener('click', function (event) 
		{
			var x = event.pageX - canvas.offsetLeft
			var y = event.pageY - canvas.offsetTop;
			game.click(x,y);
		},false);
	}//end of loaded
</script>
</head>


<body onLoad="loaded()">
	<canvas id="myCanvas" width="1000" height="800"></canvas>
</body>

</html>